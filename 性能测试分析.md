# 性能测试分析

## 测试机环境

* OS: Unbuntu 18.04 (虚拟机，宿主机为Win10)

* 宿主机硬件:
    1. CPU: i5-6500T
    2. 内存: 8GB
 
* 虚拟机分配资源
    1. CPU资源: 4核
    2. 内存: 4GB
    

## 测试工具

* [webbench](https://github.com/EZLippi/WebBench)


## 测试用例


### case-01

* 关闭系统所有调试信息以及输出，**4** 个工作线程并以守护进程运行(./webserver -d -t 4 -p 8080)


* 页面大小: **575** bytes/page

* wenbench设置: **1000**客户端、连接60s、短连接

**测试结果:**

QPS: 37665
传输速度: 24.5 MB/S


![4thread_1000client_60s](https://ws2.sinaimg.cn/large/006tKfTcgy1g0oopho0lqj30w60eaq4c.jpg)


### case-02

* 关闭系统所有调试信息以及输出，**8** 个工作线程并以守护进程运行(./webserver -d -t 8 -p 8080)


* 页面大小: **575** bytes/page

* wenbench设置: **1000**客户端、连接60s、短连接

**测试结果:**

QPS: 34263
传输速度: 22.5 MB/S

![8thread_1000client_60s](https://ws2.sinaimg.cn/large/006tKfTcgy1g0op8am8isj30ww0eiq4c.jpg)


###分析

* 我的给虚拟机配置的是四个核心，所以其实从结果可以看出开8个线程的反而比开四个线程的QPS略低，应该是线程之间切换开销增大造成的，
而四个线程正好匹配核心，性能达到最高

* 大概可以推测出WebServer的传输性能极限应该在 25MB/s，这是远低于Nginx等高性能Web服务器的水准的，还有待改进，进一步提高并发度





